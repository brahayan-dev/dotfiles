---
- name: Install Development Stack (Linux)
  become: true
  dnf:
    name:
      - npm
      - gcc
      - gcc-c++
      - make
      - glibc-devel
      - pkgconf-pkg-config
      - rust
      - cargo
      - openssl-devel
      - libyaml-devel
      - zlib-devel
      - gmp-devel
      - golang
      - libffi-devel
      - readline-devel
      - libffi-devel
      - readline-devel
      - podman
      - direnv
      - opentofu
      - dbeaver-ce
    state: present
  when: ansible_os_family == "RedHat"

- name: Install Mise
  shell: |
    curl https://mise.run | sh
  args:
    creates: "/{{ base_dir }}/{{ current_user }}/.local/bin/mise"
  notify: Reload Zsh Files
  when: akeptous_file.stat.exists

- name: Install NVM
  shell: |
    curl -o- "https://raw.githubusercontent.com/nvm-sh/nvm/v{{ nvm_version }}/install.sh" | bash
  args:
    creates: "/{{ base_dir }}/{{ current_user }}/.nvm/nvm.sh"
  when:
    - akeptous_file.stat.exists

- name: Install Development Stack (macOS)
  community.general.homebrew:
    name:
      - jq
      - gh
      - npm
      - gmp
      - rust
      - lima
      - podman
      - golang
      - direnv
      - libyaml
      - ghostty
      - opentofu
      - openssl@3
      - dbeaver-community
    state: present
  notify: Reload Zsh Files
  when: akeptous_file.stat.exists and (ansible_os_family == "Darwin")
